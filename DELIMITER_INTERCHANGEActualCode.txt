import java.util.Date
import scala.io.Source
import java.io.File
val readFile=Source.fromFile(new File("/CTRLFW/SCUDEE/bala/TL_THRESHOLD_ROLLUP.D2017051.T221737601Siva.R000006")).getLines
def process(readFile:Iterator[String]):Iterator[String]=
{
val list=List("-",".") 
val dmap=Map('-'->'_','.'->'_')
val x=readFile.map(x=>x.map(y=>dmap.getOrElse(y,y)))
return x
}
val delimitedfile=process(readFile)
def test(lis:List[Char]):List[Char]= lis match{
case Nil => Nil
case h::tail if(h=='_')=>h::test(tail.dropWhile(_==h))
case h::tail =>h::test(tail)
}
val delimitedfile1=delimitedfile.map(x=>x.toList).map(y=>test(y))
for(x<-delimitedfile1)yield (x.mkString)


Input:
2017-.-22-.20 22:01:11.000011525726611IGGADMINHKHKGHK33500C00.2092512017--02-21 00:00:00447068505242123084.0000000000000000001.0317downstream2017-02-21 06:01:051018850.000HKD0T
2017---02-20 22:01:24.0000242IGGADMINSGSINSG10526C000183112017-02-21 00:00:00017073818311000.0000000000000000001.0315downstream2017-02-21 06:01:151018930.000USD0T
2017-02-20 22:01:25.0000255257267431BGGADMINSGSINSG10526C000183112017-02-21 00:00:00017073818311000.0000000000000000001.0315downstream2017-02-21 06:01:151018930.000USD0T
2017-02-20 22:01:25.000025525726743AGGADMINSGSINSG10526C000183112017-02-21 00:00:00017073818311000.0000000000000000001.0315downstream2017-02-21 06:01:1510189332331.120USD9a8b7c6d-2017-0221-0601-000000101893PAYPAYROLL RESTRICT FOR SUPERTIME DEP9T
2017-02-20 22:01:25.000025525726743BGGADMINSGSINSG10526C000183112017-02-21 00:00:00017073818311000.0000000000000000001.0315downstream2017-02-21 06:01:1510189332331.120USD9a8b7c6d-2017-0221-0601-000000101893PAYPAYROLL RESTRICT FOR SUPERTIME DEP9T
2017-02-20 22:01:25.000025525726743AGGADMINSGSINSG10526C000183112017-02-21 00:00:00017073818311000.0000000000000000001.0342downstream2017-02-21 06:01:1510189332331.120USD9a8b7c6d-2017-0221-0601-000000101893PAYPAYROLL RESTRICT FOR SUPERTIME DEP9T
2017-02-20 22:01:34.000034525726793IGGADMINHKHKGHK30682C000748712017-02-21 00:00:0044706850494134170.2783300000000000002.0317downstream2017-02-21 06:01:261019000.000HKD0T
2017-02-20 22:01:34.000034525726793IGGADMINHKHKGHK03801D001818912017-02-21 00:00:004470798424929041.2290960000000000001.0317downstream2017-02-21 06:01:291019030.000USD0T



Output:
2017_22_20 22:01:11_000011525726611IGGADMINHKHKGHK33500C00_2092512017_02_21 00:00:00447068505242123084_0000000000000000001_0317downstream2017_02_21 06:01:051018850_000HKD0T
2017_02_20 22:01:24_0000242IGGADMINSGSINSG10526C000183112017_02_21 00:00:00017073818311000_0000000000000000001_0315downstream2017_02_21 06:01:151018930_000USD0T
2017_02_20 22:01:25_0000255257267431BGGADMINSGSINSG10526C000183112017_02_21 00:00:00017073818311000_0000000000000000001_0315downstream2017_02_21 06:01:151018930_000USD0T
2017_02_20 22:01:25_000025525726743AGGADMINSGSINSG10526C000183112017_02_21 00:00:00017073818311000_0000000000000000001_0315downstream2017_02_21 06:01:1510189332331_120USD9a8b7c6d_2017_0221_0601_000000101893PAYPAYROLL RESTRICT FOR SUPERTIME DEP9T
2017_02_20 22:01:25_000025525726743BGGADMINSGSINSG10526C000183112017_02_21 00:00:00017073818311000_0000000000000000001_0315downstream2017_02_21 06:01:1510189332331_120USD9a8b7c6d_2017_0221_0601_000000101893PAYPAYROLL RESTRICT FOR SUPERTIME DEP9T
2017_02_20 22:01:25_000025525726743AGGADMINSGSINSG10526C000183112017_02_21 00:00:00017073818311000_0000000000000000001_0342downstream2017_02_21 06:01:1510189332331_120USD9a8b7c6d_2017_0221_0601_000000101893PAYPAYROLL RESTRICT FOR SUPERTIME DEP9T
2017_02_20 22:01:34_000034525726793IGGADMINHKHKGHK30682C000748712017_02_21 00:00:0044706850494134170_2783300000000000002_0317downstream2017_02_21 06:01:261019000_000HKD0T
2017_02_20 22:01:34_000034525726793IGGADMINHKHKGHK03801D001818912017_02_21 00:00:004470798424929041_2290960000000000001_0317downstream2017_02_21 06:01:291019030_000USD0T
